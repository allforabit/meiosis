<!DOCTYPE html>
<html>
  <head>
    <title>Meiosis Wiki</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="normalize.css">
    <link rel="stylesheet" href="skeleton.css">
    <link rel="stylesheet" href="prism.css">
    <link rel="stylesheet" href="style.css">
  </head>
  <body class="container">
    <script src="prism.js" type="text/javascript"></script>
    <script src="https://flems.io/flems.html" type="text/javascript" charset="utf-8"></script>
    <h1><a href="http://meiosis.js.org">Meiosis</a> Wiki</h1><p><a href="toc.html">Table of Contents</a></p>
<h2>Ramda</h2><p>In the <a href="03-Model-and-Nesting-A-Lodash-FP.html">previous section</a>, we looked at
<a href="https://github.com/lodash/lodash/wiki/FP-Guide">Lodash-FP</a> to improve our model and nesting
functions. We used curried, data-last functions and point-free style.</p>
<p><a href="http://ramdajs.com">Ramda</a> is another fine library for functional programming. From its home
page:</p>
<blockquote>
<p>Ramda emphasizes a purer functional style. Immutability and side-effect free functions are at the
heart of its design philosophy. This can help you get the job done with simple, elegant code.</p>
</blockquote>
<p>While Lodash-FP was created after Lodash had been in existence for a while, Ramda was designed from
the start to provide curried, data-last functions. Choosing between Ramda and Lodash is much like
choosing a code editor, IDE, shell, and so on: the best one is the one that makes <em>you</em> most
productive.</p>
<p>And again, keep in mind that this is not a requirement for using Meiosis.</p>
<h3>Setting a Property</h3><p>With Lodash-FP, we used <code>_.set</code>:</p>
<pre><code class="language-javascript">editDate: evt =&gt; update(_.set(&quot;date&quot;, evt.target.value))</code></pre>
<p>The equivalent function in Ramda is <code>assoc</code>:</p>
<pre><code class="language-javascript">editDate: evt =&gt; update(R.assoc(&quot;date&quot;, evt.target.value))</code></pre>
<p>The above is short for <code>update(model =&gt; R.assoc(&quot;date&quot;, evt.target.value, model))</code>.
Since <code>R.assoc</code> is curried and data-last, we were able to write the code in point-free style.</p>
<p>We could go one step further. Notice that our function takes <code>evt</code> and pass <code>evt.target.value</code> to
<code>R.assoc(&quot;date&quot;, evt.target.value)</code> which is data-last, and passes the result to <code>update()</code>.</p>
<p>We can describe this as the following steps:</p>
<ul>
<li>extract <code>target.value</code> from <code>evt</code></li>
<li>pass the result to <code>R.assoc(&quot;date&quot;)</code></li>
<li>pass the result to <code>update()</code></li>
</ul>
<p>We can achieve this using function composition, <code>R.compose</code> to write our function as follows:</p>
<pre><code class="language-javascript">editDate: R.compose(update, R.assoc(&quot;date&quot;), R.path([&quot;target&quot;, &quot;value&quot;]))</code></pre>
<p><code>R.compose</code> calls functions right-to-left, passing the result of one function to the next.</p>
<h3>Using Lenses</h3><p>With Lodash-FP, we used <code>_.update</code> to update a value using a function:</p>
<pre><code class="language-javascript">increase: value =&gt; update(_.update(&quot;value&quot;, _.add(value))),</code></pre>
<p>Recall that this is the equivalent of</p>
<pre><code class="language-javascript">increase: value =&gt; update(model =&gt; _.set(&quot;value&quot;, _.add(value, _.get(&quot;value&quot;, model)), model))</code></pre>
<p>With Ramda, the equivalent of <code>_.update</code> is <code>R.over</code>. Instead of just specifying a property,
though, <code>R.over</code> expects a <a href="http://ramdajs.com/docs/#lens">lens</a>. In short, a lens is a way of
getting and setting a value on an object. For example, a lens for a nested property can be
created with <code>R.lensProp(&quot;property&quot;)</code>, and for a more deeply nested property,
<code>R.lensPath([&quot;nested&quot;, &quot;property&quot;])</code>.</p>
<p>Once we&#39;ve created a lens, we pass it to <code>R.over</code> to update the lens target with a function:</p>
<pre><code class="language-javascript">increase: value =&gt; update(model =&gt; R.over(R.lensProp(&quot;value&quot;), R.add(value), model))</code></pre>
<p>Notice that again, <code>model</code> is passed as the last argument to the function. Remember that when
we have <code>x =&gt; f(x)</code>, we can make this more concise with the point-free form, <code>f</code>. So, we
can write:</p>
<pre><code class="language-javascript">increase: value =&gt; update(R.over(R.lensProp(&quot;value&quot;), R.add(value)))</code></pre>
<p>The result of <code>R.add()</code> is passed to <code>R.over()</code>, which is then passed to <code>update</code>. We can
use function composition:</p>
<pre><code class="language-javascript">increase: value =&gt; R.compose(update, R.over(R.lensProp(&quot;value&quot;)), R.add(value))</code></pre>
<p>Now <code>value</code> is passed as the last argument, so we can use the point-free form:</p>
<pre><code class="language-javascript">increase: R.compose(update, R.over(R.lensProp(&quot;value&quot;)), R.add)</code></pre>
<p>These functional programming constructs can be very nice, but perhaps harder to decipher when
we&#39;re not used to them. It&#39;s up to you to decide how &quot;far&quot; to go. The more concise form is
arguably more elegant, but less explicit as to what is going on.</p>
  <div id="flems1" class="flemscode" style="height:800px"></div>

  <script>
    window.Flems(flems1, {
      files: [{name: "nest.js", content: "/* global R */\n\nconst nestUpdate = (update, path) => func =>\n  update(R.over(R.lensPath(path), func));\n\n// eslint-disable-next-line no-unused-vars\nconst nest = (create, update, path) => {\n  const component = create(nestUpdate(update, path));\n  const result = R.merge({}, component);\n  if (component.model) {\n    result.model = () => R.assocPath(path, component.model(), {});\n  }\n  if (component.view) {\n    result.view = R.compose(component.view, R.path(path));\n  }\n  return result;\n};\n", compiler: "babel"},{name: "temperature.js", content: "/* global R, React */\n\nconst convert = (value, to) => Math.round(\n  (to === \"C\") ? ((value - 32) / 9 * 5) : (value * 9 / 5 + 32)\n);\n\nconst createActions = update => ({\n  editDate: evt =>\n    update(R.assoc(\"date\", evt.target.value)),\n\n  increase: amount => _evt =>\n    update(R.over(R.lensProp(\"value\"), R.add(amount))),\n\n  changeUnits: _evt => update(model => {\n    const newUnits = model.units === \"C\" ? \"F\" : \"C\";\n    const newValue = convert(model.value, newUnits);\n    return R.merge(model, { units: newUnits, value: newValue });\n  })\n});\n\nconst createView = actions => model => (\n  <div>\n    <div>Date: <input type=\"text\" size=\"10\" value={model.date} onChange={actions.editDate}/></div>\n    <span>Temperature: {model.value}&deg;{model.units} </span>\n    <div>\n      <button onClick={actions.increase(1)}>Increase</button>\n      <button onClick={actions.increase(-1)}>Decrease</button>\n    </div>\n    <div>\n      <button onClick={actions.changeUnits}>Change Units</button>\n    </div>\n  </div>\n);\n\n// eslint-disable-next-line no-unused-vars\nconst createTemperature = update => ({\n  model: () => ({\n    date: \"\",\n    value: 20,\n    units: \"C\"\n  }),\n\n  view: createView(createActions(update))\n});\n", compiler: "babel"},{name: "app.js", content: "/* global R, React, nest, createTemperature */\n\n// eslint-disable-next-line no-unused-vars\nconst createApp = update => {\n  const air = nest(createTemperature, update, [\"air\"]);\n  const water = nest(createTemperature, update, [\"water\"]);\n\n  return {\n    model: () => R.merge(air.model(), water.model()),\n    view: model => (\n      <div>\n        {air.view(model)}\n        {water.view(model)}\n      </div>\n    )\n  };\n};\n", compiler: "babel"},{name: "index.js", content: "/* global ReactDOM, flyd, createApp, meiosis, meiosisTracer */\n\nconst update = flyd.stream();\nconst app = createApp(update);\nconst models = flyd.scan((model, func) => func(model),\n  app.model(), update);\n\nconst element = document.getElementById(\"app\");\nmodels.map(model => ReactDOM.render(app.view(model), element));\n\n// Only for using Meiosis Tracer in development.\nmeiosis.trace({ update, dataStreams: [ models ] });\nmeiosisTracer({ selector: \"#tracer\" });\n", compiler: "babel"},{name: "app.html", content: "<div id=\"app\"></div>\n<div id=\"tracer\"></div>\n"},{name: "app.css", content: "body, button {\n  font-family: sans-serif;\n  font-size: 1rem;\n}\nbutton, button.light {\n  cursor: pointer;\n  padding: 2px 8px 2px 8px;\n  color: #5755d9;\n  background-color: #ffffff;\n  border: 1px solid #5755d9;\n  margin: 4px;\n}\nbutton:hover {\n  background-color: #eeeeee;\n}\nbutton.dark {\n  background-color: #5755d9;\n  color: #ffffff;\n}\nbutton.dark:hover {\n  background-color: #7775f9;\n}\n.temperature {\n  margin-bottom: 20px;\n}"}],
      links: [{name: "react", type: "js", url: "https://unpkg.com/react@16.4.1/umd/react.development.js"},{name: "react-dom", type: "js", url: "https://unpkg.com/react-dom@16.4.1/umd/react-dom.development.js"},{name: "flyd", type: "js", url: "https://unpkg.com/flyd@0.2.8/flyd.js"},{name: "ramda", type: "js", url: "https://unpkg.com/ramda@0.25.0/dist/ramda.min.js"},{name: "meiosis", type: "js", url: "https://unpkg.com/meiosis@1.4.1/dist/meiosis.js"},{name: "meiosis-tracer", type: "js", url: "https://unpkg.com/meiosis-tracer@1.4.1/dist/meiosis-tracer.js"}],
      middle: 75,
      autoFocus: false
    })
  </script>


<h3>Principles / Takeaways</h3><ul>
<li>Ramda is another nice library for functional programming.</li>
<li>Functions in Ramda are curried and data-last.</li>
<li>The Meiosis pattern makes it possible, <em>but not required</em>, to use functional programming
concepts.</li>
</ul>
<h3>Up Next</h3><p>In the next section, we&#39;ll look at using <a href="03-Model-and-Nesting-C-Patchinko.html">Patchinko</a>.</p>
<p><a href="toc.html">Table of Contents</a></p>
<hr>
<p><a href="http://meiosis.js.org">Meiosis</a> is developed by <a href="http://twitter.com/foxdonut00">@foxdonut00</a> / <a href="https://github.com/foxdonut">foxdonut</a> and is released under the MIT license.</p>
  </body>
</html>