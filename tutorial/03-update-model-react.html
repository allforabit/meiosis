<!DOCTYPE html>
<html>
  <head>
    <title>Meiosis Tutorial</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="normalize.css">
    <link rel="stylesheet" href="skeleton.css">
    <link rel="stylesheet" href="prism.css">
    <link rel="stylesheet" href="style.css">
  </head>
  <body class="container">
    <script src="prism.js" type="text/javascript"></script>
    <script src="https://flems.io/flems.html" type="text/javascript" charset="utf-8"></script>
    <h1><a href="https://meiosis.js.org">Meiosis</a> Tutorial</h1><p><a href="toc.html">Table of Contents</a></p>
<h2>03 - Update Model</h2><p>In the previous lesson, <a href="02-view-function-react.html">02 - View Function</a>, we created a <code>view</code>
function that produces the vnode according to the <code>model</code> that is passed to the function.</p>
<p>So, we can call <code>view(model)</code> and render it onto the page. Now, how do we make a change to the
model and refresh the view?</p>
<p>Our model is a counter that has a value of <code>0</code>. Let&#39;s add a button to increase the counter.</p>
<h3>DOM Event Handler Functions</h3><p>We can add a <code>+1</code> button with this code:</p>
<pre><code class="language-html">&lt;button onClick={increase}&gt;+1&lt;/button&gt;</code></pre>
<p>It is important to remember that what we associate to <code>onClick</code> must be a <strong>function</strong>. This
function will automatically be called when the user clicks on the button, and the function gets
passed a DOM event as a parameter. Here, the function is <code>increase</code>:</p>
<pre><code class="language-js">var increase = function(_event) {
  model = model + 1;
  ReactDOM.render(view(model), element);
};</code></pre>
<blockquote>
<p><strong>Note:</strong> the <code>increase</code> function does not need to do anything with the DOM event. So, <code>increase</code>
could have been a function with no parameters. For clarity, I included the event parameter in
the function declaration, prefixed with an underscore to indicate that the parameter is not
used.</p>
</blockquote>
<h3>Updating the Model and Re-rendering the View</h3><p>As you can see in the code above, the <code>increase</code> function updates the model by adding 1 to the
value. Then, it re-renders the view by calling <code>ReactDOM.render</code> again.</p>
<p><img src="03-update-model-02.svg" alt="The onclick Function"></p>
<blockquote>
<p><strong>Note:</strong> you might wonder about rebuilding the whole view and re-rendering it when something
changes. Generally speaking, producing a vnode is not a performance concern. Further, re-rendering
the view is what virtual-DOM libraries are good at: figuring out what minimal changes are needed to
make the real DOM reflect the view.</p>
</blockquote>
<p>You can see the working code below:</p>
<div id="flems1" class="flemscode" style="height:550px"></div>
  <script>
    window.Flems(flems1, {
      files: [{name: "03-update-model.js", content: "/*global React, ReactDOM*/\nvar model = 0;\n\nvar increase = function(_event) {\n  model = model + 1;\n  ReactDOM.render(view(model), element);\n};\n\nvar view = function(model) {\n  return (<div>\n    <div>Counter: {model}</div>\n    <button onClick={increase}>+1</button>\n  </div>);\n};\n\nvar element = document.getElementById(\"app\");\nReactDOM.render(view(model), element);\n", compiler: "babel"},{name: "app.html", content: "<div id=\"app\"></div>\n"},{name: "app.css", content: "body, button {\n  font-family: sans-serif;\n  font-size: 1rem;\n}\nbutton, button.light {\n  cursor: pointer;\n  padding: 2px 8px 2px 8px;\n  color: #5755d9;\n  background-color: #ffffff;\n  border: 1px solid #5755d9;\n  margin: 4px;\n}\nbutton:hover {\n  background-color: #eeeeee;\n}\nbutton.dark {\n  background-color: #5755d9;\n  color: #ffffff;\n}\nbutton.dark:hover {\n  background-color: #7775f9;\n}\n.temperature, .humidity {\n  margin-bottom: 20px;\n}"}],
      links: [{name: "react", type: "js", url: "https://unpkg.com/react@16.4.1/umd/react.development.js"},{name: "react-dom", type: "js", url: "https://unpkg.com/react-dom@16.4.1/umd/react-dom.development.js"}],
      middle: 75
    })
  </script>


<h3>Exercises</h3><ol>
<li>As in the <a href="02-view-function-react.html">previous lesson</a>, try passing in an object such as
<code>{ label: &quot;The Counter&quot;, value: 0 }</code> as the model. Change the <code>view</code> function so that it uses the
model to produce the view, and change the <code>increase</code> function so that it increases the model value.</li>
<li>Add a <code>-1</code> button that decreases the value by 1.</li>
</ol>
<h3>Solution</h3><div style="margin-bottom: 24px"><a href="javascript:" onclick="this.style.display='none';document.getElementById('flems2').style.display='block'">Show solution</a></div><div id="flems2" class="flemscode" style="height:750px; display: none"></div>
  <script>
    window.Flems(flems2, {
      files: [{name: "03-update-model-solution.js", content: "/*global React, ReactDOM*/\n// Pass an object as the model\nvar model = { label: \"The Counter\", value: 0 };\n\n// Change the increase function to increase the model value\nvar increase = function(_event) {\n  model.value = model.value + 1;\n  ReactDOM.render(view(model), element);\n};\n\n// Add a decrease function\nvar decrease = function(_event) {\n  model.value = model.value - 1;\n  ReactDOM.render(view(model), element);\n};\n\n// Use the model to produce the view\nvar view = function(model) {\n  return (<div>\n    <div>{model.label}: {model.value}</div>\n    <button onClick={increase}>+1</button>\n    {/* Add a -1 button that decreases the value */}\n    <button onClick={decrease}>-1</button>\n  </div>);\n};\n\nvar element = document.getElementById(\"app\");\nReactDOM.render(view(model), element);\n", compiler: "babel"},{name: "app.html", content: "<div id=\"app\"></div>\n"},{name: "app.css", content: "body, button {\n  font-family: sans-serif;\n  font-size: 1rem;\n}\nbutton, button.light {\n  cursor: pointer;\n  padding: 2px 8px 2px 8px;\n  color: #5755d9;\n  background-color: #ffffff;\n  border: 1px solid #5755d9;\n  margin: 4px;\n}\nbutton:hover {\n  background-color: #eeeeee;\n}\nbutton.dark {\n  background-color: #5755d9;\n  color: #ffffff;\n}\nbutton.dark:hover {\n  background-color: #7775f9;\n}\n.temperature, .humidity {\n  margin-bottom: 20px;\n}"}],
      links: [{name: "react", type: "js", url: "https://unpkg.com/react@16.4.1/umd/react.development.js"},{name: "react-dom", type: "js", url: "https://unpkg.com/react-dom@16.4.1/umd/react-dom.development.js"}],
      middle: 75
    })
  </script>


<p>When you are ready, continue on to <a href="04-update-function-react.html">04 - Update Function</a>.</p>
<p><a href="toc.html">Table of Contents</a></p>
<hr>
<p><a href="https://meiosis.js.org">Meiosis</a> is developed by <a href="http://twitter.com/foxdonut00">@foxdonut00</a> / <a href="https://github.com/foxdonut">foxdonut</a> and is released under the MIT license.</p>
  </body>
</html>